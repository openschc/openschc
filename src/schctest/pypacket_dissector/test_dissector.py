import unittest

try:
    from pypacket_dissector import decoder as dis
    print("# pypacket_dissector test")
except:
    import decoder as dis
    print("# module test")

class Test_dissector(unittest.TestCase):

    test_packet = [
        bytearray(b'`\x00\x00\x00\x00-\x11\x1e\xfe\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\xfe\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x162\x163\x00-\x00\x00A\x02\x00\x01\x82\xb3foo\x03bar\x06ABCD==Fk=eth0\xff\x82\x19\x0bd\x1a\x00\x01\x8e\x96'),
        bytearray(b'`\x12\x34\x56\x00\x1e\x11\x1e\xfe\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\xfe\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x162\x163\x00\x1e\x00\x00A\x02\x00\x01\n\xb3foo\xff\x84\x01\x82  &Ehello'),
        bytearray(b'`\x12\x34\x56\x00\x1e\x11\x1e\xfe\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\xfe\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x162\x163\x00\x1e\x00\x00A\x02\x00\x01\n\xb3foo\x03bar\x06ABCD==Fk=eth0\xff\x84\x01\x82  &Ehello'),
        bytearray(b'`\x0c_"\x00\x10:@\xfe\x80\x00\x00\x00\x00\x00\x00\xae\xbc2\xff\xfe\xba\x1c\x9f\xfe\x80\x00\x00\x00\x00\x00\x00\x02\x01\xc0\xff\xfe\x06>i\x80\x00J\xc4y\x83\x00\x00Z\x84\x0c|\x00\x00Z\xe4')
        ]

    def test_x(self):
        for i in self.test_packet:
            ret = dis.decoder(i)
            #print(ret)
            print("===")
            print(dis.dumps(ret, indent=4))

if __name__ == '__main__':
    unittest.main()
